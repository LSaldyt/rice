{"version":3,"sources":["webpack:///webpack/bootstrap 072a31b12465057f48cd","webpack:///./src/lib/dom.js","webpack:///./src/lib/keys.js","webpack:///./node_modules/mosi/client.js","webpack:///./src/lib/browser_polyfill.js","webpack:///./node_modules/mosi/node.js","webpack:///./node_modules/webextension-polyfill/dist/browser-polyfill.js","webpack:///./src/lib/util.js","webpack:///./src/lib/friendlyCodeStrings.json","webpack:///./src/storage/storage.js","webpack:///./src/options/Keybindings/trie.js","webpack:///./src/options/Keybindings/index.js","webpack:///./src/options/Appearance/index.js","webpack:///./src/options/General/index.js","webpack:///./src/storage/transform.js","webpack:///./src/storage/procedures.js","webpack:///./node_modules/compare-versions/index.js","webpack:///./src/background_page/modes.js","webpack:///./src/modes/command/background/commands/tab.js","webpack:///./src/lib/url.js","webpack:///./src/modes/command/background/commands/clipboard.js","webpack:///./src/modes/hints/background/hintStrings.js","webpack:///./node_modules/mosi/core.js","webpack:///./src/modes/command/background/index.js","webpack:///./src/modes/hints/background/index.js","webpack:///./src/background_page/index.js"],"names":[],"mappings":"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,kBACpB,MAAM,SAAQ,QAAQ,OAAO,CAAE,IAAK,EAAU,gBAC/C,c,CCrBgD,eAC/C,MACA,WAAI,GACJ,OAAO,EAAwB,YAA0B,CAAjB,KAAM,QAC5C,MAAM,GAAO,EACb,SAAK,KACH,UAAM,KAET,IACD,OAAO,GAAY,QACpB,I,88CCV6C,GAC9C,OACA,cACA,2BACA,6BACA,iBAEA,oBAEA,WACA,UACA,KAAuB,cACvB,cAEA,eACA,cACA,OAA0B,6EAC1B,SAGA,8BAFA,8BACA,UAEA,mBACA,gCAOA,qCACA,2BACA,SAEA,qCACA,IACA,KAAuB,cACvB,cACA,eACA,cACA,OAA0B,wEAC1B,8BACA,cACA,2BACA,SACA,6CACA,8CACA,MACA,EACA,mBACA,cACA,CACA,yBAUA,iBAAkB,+DAA8E,YAChG,MACA,oBACA,qBACA,oDACA,MAAe,oBAA0C,6BACzD,yBACA,2CACA,iDACA,sBACA,+BACA,mCACA,IACA,yCACA,YAA8B,sBAAuB,KACrD,MACA,aACA,EACA,yBACA,IACA,MACA,UACA,oBAaA,yCACA,mBAEA,qCAEA,6CAjBA,MACS,SACT,0BAEA,eAEA,qBAEA,wDAEA,kBALW,kDAMJ,OAOP,KAMA,uBACA,iBACuB,wBACvB,gCAAwB,CAAO,UAC/B,CACA,mBACA,6BAA4B,8BAE5B,yBAEA,6BACA,EACA,iCAUA,gCAEA,sDA0CA,YAzCA,MAAgC,OAChC,qCACA,+BACA,WACA,YAEA,YACA,qBAEA,kBACA,wBAEA,kBACA,iEAEA,WACA,2DAEA,SACA,sDAEA,mBACA,gBACA,oCAEA,oBACA,kBACA,sCAEA,oBAEA,+CAGA,GAAW,SACX,QAAiC,KACjC,QACA,CACA,QAEA,EAEA,+BACA,IACA,OAAgB,mBAChB,qBAAO,SACP,OAAgB,MAChB,IACA,CACA,kBACA,gCACA,wBACA,gBACA,6BACA,6BAAuC,uCAEvC,yBAEA,6BAEA,8BACA,iBACA,kBACA,QAEA,6BACA,UAGA,0BACA,0BACA,MAAO,SACP,6CACA,qBACA,WACA,CACA,iCAMA,gCACA,0BACA,eACA,iDACA,+BACA,SAIA,wBAA6B,4CAA8C,eAC3E,CAEA,OAF8B,6CAC9B,WAEA,oBACA,oBACA,cACA,UACA,oBACA,gDACA,eACA,+BAA8B,oCAC9B,OAAW,cACX,2BAAqD,CACrD,sBAA8B,kCAA6C,CAAI,KAC/E,OACA,GACA,UACA,oBACA,0CAEA,+BAKA,cACA,MACA,oBAAgD,2BAEhD,KACA,iBACA,0BAEA,oBACA,WACA,gBACA,eACA,cACA,YAIA,YAEA,wCAA2C,8BAAgC,WAE3E,yBACA,kEACA,YACA,aAEA,GACA,EACA,EACA,QACA,UACA,SACA,SACA,SACQ,gCLzRR,IAKO,GAAY,OAEnB,KAAM,IACJ,iBAAiB,IAAQ,CACzB,EAAU,oBAyDH,KAAK,WAAW,YAAyB,KAM9C,YAAQ,KAAmB,gBACzB,MACA,4BACA,mBACA,iBAEH,oBACF,GAED,GAAI,IAoBJ,OAAO,QAAQ,UAEf,wBCxGA,GA8HA,GAAI,IAEJ,GAkDA,MCtFA,KA2yBA,67MAaA,4ECr5BA,mKGEA,KACE,UAEK,4KCLP,EAEA,GAAI,IACJ,aAEA,aACE,iBAAiB,KACf,IAAwC,CAA5B,IAAQ,UAAU,OAAc,EAAQ,UACpD,SAAmB,EACpB,gBACD,cACE,WAA0B,YAExB,MAAM,UAA+B,MAAW,KAAW,QAAjC,CAC1B,IAAM,EAAgB,KAAU,MAChC,eAAM,EAAa,EAAc,OAAQ,GAAO,CAAE,OAAgB,IAElE,MACE,CADE,KACE,IAEL,qBAAM,IAAwB,CAApB,SACT,MAAM,CAAE,MAAO,EAAc,KAAK,CAAC,CAAE,IAAG,QACxC,CADiD,MAC3C,CAAC,CAAK,MAAc,KAAU,MACpC,qBAAI,IAEL,kBALM,KAML,MAAM,GACN,WAAI,GACJ,IAAc,QAAQ,CAAC,CAAE,KAAI,OAC3B,MAAM,GACN,IAAI,IAAI,cAAe,EACvB,YACD,GACF,EACF,CACD,aAA0B,YACxB,MAAM,UAA+B,MAAW,KAAW,QAAjC,CAC1B,OACE,MAAM,GAAU,KAAU,MAC1B,qBAAI,EAAQ,MAAM,CAAC,CAAE,OACnB,UAD2B,MAI7B,WAHM,KACJ,sBAEI,GAAW,EAAQ,KACvB,CAAC,CAAE,OAAc,MAAN,MAAsB,UAAN,MAG3B,eAAI,IAAkB,gBAAiB,EAE1C,EAZD,CAYS,QAAK,CACf,CACD,4BAA2B,KAEzB,SAAQ,QAAQ,OAAO,CAAE,MAC1B,cCxCL,QACA,KAAM,IACJ,CACA,WRKmC,mBACnC,MAAM,CAAE,OAAQ,CAAE,UAAS,IAAK,CAAS,QAAc,QAIvD,MAAiB,CAUf,CAVE,iBAUI,SAAQ,KAAmB,gBAC/B,MACA,qBACA,gBACA,iBAGL,qBAED,EQ1BA,cRiEoC,aAClC,CAAI,IACL,sBQlED,EACE,CACA,OAFG,aRPsC,aACzC,CACA,YAAe,WAAgB,IAAI,CAAQ,QACzC,CAAM,MAAQ,OACd,uBAAc,SAAe,MAC9B,SACF,GQMD,CAEI,CACA,WAEF,cRkFoB,gBACpB,MACA,UACD,KQ9EA","file":"background_page.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 36);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 072a31b12465057f48cd","/**\n * Given a DOM element, returns true if you can edit it with key presses or\n * if the element is of a type that should handle its own keypresses\n * (e.g. role=application for google docs/sheets)\n * TODO: work on case sensitivity\n * consider all the possible cases\n * @param {HTMLElement} element\n * @returns {boolean}\n */\nexport function isTextEditable (element) {\n  if (element) {\n    switch (element.nodeName) {\n      case 'INPUT':\n        return isEditableHTMLInput(element)\n      case 'TEXTAREA':\n      case 'OBJECT':\n        return true\n    }\n    switch (true) {\n      case element.contentEditable.toUpperCase() === 'TRUE':\n      case element.role === 'application':\n        return true\n    }\n  }\n  return false\n}\n\n/**\n * Returns whether the passed HTML input element is editable\n * @param {HTMLInputElement} element\n */\nfunction isEditableHTMLInput (element) {\n  if (element.disabled || element.readonly) return false\n  switch (element.type) {\n    case undefined:\n    case 'text':\n    case 'search':\n    case 'email':\n    case 'url':\n    case 'number':\n    case 'password':\n    case 'date':\n    case 'tel':\n      return true\n  }\n  return false\n}\n\n/**\n * Like document.activeElement, but penetrates through Shadow DOM\n * A good example is: https://web.archive.org/web/20170621214451/https://material.io/icons/\n * Click on the input. document.activeElement is different from deepActiveElement()\n * @param {HTMLElement} root\n */\nexport function deepActiveElement (root = document) {\n  const activeElement = root.activeElement\n  const activeElementShadowRoot = activeElement && activeElement.shadowRoot\n  return activeElementShadowRoot\n    ? deepActiveElement(activeElementShadowRoot)\n    : activeElement\n}\n\n/**\n * Dispatch a mouse event to the target element\n * based on cVim's implementation\n * @param {HTMLElement} element\n * @param {'hover' | 'unhover' | 'click'} type\n * @param {{ ctrlKey, shiftKey, altKey, metaKey }} modifierKeys\n */\nexport function mouseEvent (element, type, modifierKeys = {}) {\n  let events\n  switch (type) {\n    case 'hover':\n      events = ['mouseover', 'mouseenter', 'mousemove']\n      break\n    case 'unhover':\n      events = ['mousemove', 'mouseout', 'mouseleave']\n      break\n    case 'click':\n      events = ['mouseover', 'mousedown', 'mouseup', 'click']\n      break\n  }\n  events.forEach(type => {\n    const event = new MouseEvent(type, {\n      bubbles: true,\n      cancelable: true,\n      view: window,\n      detail: 1, // usually the click count\n      ...modifierKeys\n    })\n    element.dispatchEvent(event)\n  })\n}\n\n/**\n * TODO: use standard fullscreenchange event when browsers support it\n */\nexport const fullscreenchange =\n  SAKA_PLATFORM === 'chrome'\n    ? 'webkitfullscreenchange'\n    : SAKA_PLATFORM === 'firefox' ? 'mozfullscreenchange' : 'fullscreenchange'\n/**\n * Given a DOM event type that is vendor pre-fixed, e.g. 'mozfullscreenchange',\n * converts it to a standardized event type, e.g. 'fullscreenchange'\n * TODO: remove this if no vendor-prefixed events are needed\n * @param {string} event\n * @returns {string}\n */\nexport function normalizeEventType (type) {\n  switch (type) {\n    case fullscreenchange:\n      return 'fullscreenchange'\n    default:\n      return type\n  }\n}\n\n// TODO: figure out why elements within shadow roots aren't registered as\n// visible/clickable, then start using this method\n/**\n * Given an HTML Element, returns a list of all elements within\n * penetrating the shadow DOM\n * @param {HTMLElement} root\n */\nexport function getAllElementsIncludingShadowDOM (root = document) {\n  const allElements = root.querySelectorAll('*')\n  let shadowDescendents = []\n  allElements.forEach(element => {\n    if (element.shadowRoot) {\n      shadowDescendents = [\n        ...shadowDescendents,\n        ...getAllElementsIncludingShadowDOM(element.shadowRoot)\n      ]\n    }\n  })\n  return [...allElements, shadowDescendents]\n}\n\n/**\n * Copies the specified text to the clipboard\n * @param {string} text\n */\nexport function copy (text) {\n  const textArea = document.createElement('textarea')\n  textArea.style = 'position:fixed;right:0'\n  textArea.value = text\n  document.body.appendChild(textArea)\n  textArea.select()\n  document.execCommand('Copy')\n  document.body.removeChild(textArea)\n}\n\n/**\n * Returns the clipboard contents.\n * This method is only callable from the background page and requires\n * the \"clipboardRead\" permission to be declared in manifest.json\n * @returns {string}\n */\nexport function paste () {\n  const textArea = document.createElement('textarea')\n  textArea.style = 'position:fixed;right:0'\n  document.body.appendChild(textArea)\n  textArea.focus()\n  document.execCommand('Paste')\n  const value = textArea.value\n  document.body.removeChild(textArea)\n  return value\n}\n\n/** Saves the given object to a human-readable JSON file */\nexport async function downloadJSON (object, filename) {\n  const url = URL.createObjectURL(\n    new Blob([JSON.stringify(object, null, 2)], {\n      type: 'data:application/json;charset=utf-8'\n    })\n  )\n  await browser.downloads.download({\n    url,\n    filename,\n    saveAs: true\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/dom.js","import friendlyCodeStrings from './friendlyCodeStrings.json'\n\nexport const isMac = navigator.appVersion.indexOf('Mac') !== -1\n\nlet _physicalKeys = true\nlet _ignoreModifierKeys = false\n\n/**\n * Configure how keyboard bindings should be interpreted and displayed\n * Options:\n * 1. physicalKeys = false: use event.code + modifierKeys\n * 2. physicalKeys = true && ignoreModifierKeys = false: use event.key + modifierKeys\n * 3. physicalKeys = true && ignoreModifierKeys = true: use event.key\n * @param {boolean} physicalKeys_\n * @param {boolean} ignoreModifierKeys_\n */\nexport function setKeyboardSettings (physicalKeys, ignoreModifierKeys) {\n  _physicalKeys = physicalKeys\n  _ignoreModifierKeys = ignoreModifierKeys\n}\n\n/**\n * Returns true if the given keyboard event is ONLY a modifier key, false otherwise\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isModifierKey (event) {\n  switch (event.key) {\n    case 'Shift':\n    case 'Control':\n    case 'Alt':\n    case 'Meta':\n      return true\n    default:\n      return false\n  }\n}\n\n/**\n * Given a keyboard event, returns a string representation of its modifiers\n * @param {KeyboardEvent} event\n * @returns {string}\n */\nfunction modifierString (event) {\n  const { shiftKey: s, ctrlKey: c, altKey: a, metaKey: m } = event\n  return `${s ? 's' : ''}${c ? 'c' : ''}${a ? 'a' : ''}${m ? 'm' : ''}`\n}\n\n/**\n * Converts a KeyboardEvent to its string representation use for internal processing\n * @param {KeyboardEvent} event\n * @param {boolean} physicalKeys\n * @param {boolean} ignoreModifierKeys\n * @returns {string}\n */\nexport function keyboardEventString (\n  event,\n  physicalKeys = _physicalKeys,\n  ignoreModifierKeys = _ignoreModifierKeys\n) {\n  return physicalKeys\n    ? `${modifierString(event)}_${event.code}`\n    : ignoreModifierKeys\n      ? `${event.key}`\n      : `${modifierString(event)}_${event.key}`\n}\n\n/** Given a keyboard event, returns a string representation of its modifiers\n * @param {KeyboardEvent} event\n * @returns {string}\n */\nfunction friendlyModifierString (event) {\n  const { shiftKey: s, ctrlKey: c, altKey: a, metaKey: m } = event\n  return `${s ? 'shift-' : ''}${c ? 'ctrl-' : ''}${a ? 'alt-' : ''}${m\n    ? 'meta-'\n    : ''}`\n}\n\n/** Given a keyboard event, returns a string representation of its modifiers\n * @param {KeyboardEvent} event\n * @returns {string}\n */\nfunction friendlyShiftlessModifierString (event) {\n  const { ctrlKey: c, altKey: a, metaKey: m } = event\n  return `${c ? 'ctrl-' : ''}${a ? 'alt-' : ''}${m ? 'meta-' : ''}`\n}\n\n/** Converts a KeyboardEvent to a user-friendly string representation.\n * @param {KeyboardEvent} event\n * @param {boolean} physicalKeys\n * @param {boolean} ignoreModifierKeys\n * @returns {string}\n */\nexport function friendlyKeyboardEventString (\n  event,\n  physicalKeys = _physicalKeys,\n  ignoreModifierKeys = _ignoreModifierKeys\n) {\n  return physicalKeys\n    ? `${friendlyModifierString(event)}${friendlyCodeStrings[event.code]\n      ? friendlyCodeStrings[event.code].value\n      : event.code}`\n    : ignoreModifierKeys\n      ? `${event.key}`\n      : `${friendlyShiftlessModifierString(event)}${event.key}`\n}\n\n/**\n * Returns whether a (possibly user-defined) keyboard event is valid\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function validKeyboardEvent (event) {\n  return (\n    event &&\n    event.key &&\n    typeof event.key === 'string' &&\n    event.code &&\n    typeof event.code === 'string' &&\n    (!event.hasOwnProperty('shiftKey') ||\n      (event.shiftKey && typeof event.shiftKey === 'boolean')) &&\n    (!event.hasOwnProperty('ctrlKey') ||\n      (event.ctrlKey && typeof event.ctrlKey === 'boolean')) &&\n    (!event.hasOwnProperty('altKey') ||\n      (event.altKey && typeof event.altKey === 'boolean')) &&\n    (!event.hasOwnProperty('metaKey') ||\n      (event.metaKey && typeof event.metaKey === 'boolean'))\n  )\n}\n\n/**\n * Extracts the important attributes from a KeyboardEvent so that\n * the event can be sent as JSON\n * @param {KeyboardEvent} event\n */\nexport function simplify ({\n  key,\n  code,\n  ctrlKey,\n  altKey,\n  metaKey,\n  shiftKey,\n  repeat\n}) {\n  return {\n    key,\n    code,\n    ctrlKey,\n    altKey,\n    metaKey,\n    shiftKey,\n    repeat\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/keys.js","import { Node, Transactions, DEFAULT_TIMEOUT } from './node';\nclass Client extends Node {\n  constructor () {\n    super(...arguments);\n    this.timeout = 1000;\n    this.transactions = new Transactions();\n    this.init = ({ subscriptions = [], onConnect = [], onDisconnect = [], actions, log = false, onClientDisconnect }) => {\n      this.initLogging(log);\n      this.subscriptions = subscriptions;\n      this.actions = actions;\n      this.onConnect = onConnect;\n      this.onDisconnect = onDisconnect;\n      this.onClientDisconnect = onClientDisconnect;\n      this.connect();\n            // firefox doesn't fire port.onDisconnect on the background page for navigation\n            // events so every content script must manually call port.disconnect() on unload\n            // TODO: remove this event listener when the following bug is fixed\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1370368\n      window.addEventListener('beforeunload', () => {\n        this.port.disconnect();\n      });\n    };\n    this.connect = () => {\n      const { subscriptions: subs, onConnect, onDisconnect } = this;\n      const connectionInfo = { name: JSON.stringify({ subs, onConnect, onDisconnect }) };\n      this.port = chrome.runtime.connect(connectionInfo);\n      this.port.onDisconnect.addListener(this.disconnectListener);\n      this.port.onMessage.addListener(this.messageListener);\n    };\n        /**\n         * If the current node is the only target, immediately execute the\n         * action locally, otherwise forward the message to the background\n         * page.\n         * Doesn't send src id because only background page populates src id.\n         */\n    this.msg = (dst, action, arg) => {\n      if (dst === 0) {\n        this.actionHandler(action, arg, 0);\n      } else {\n        this.log('Tx', 'msg', 0, dst, action, arg);\n        this.port.postMessage({ t: 'msg', dst, action, arg });\n      }\n    };\n    this._getLocal = async (localId, src, action, arg) => {\n      try {\n        return { id: localId, v: await this.actionHandler(action, arg, src) };\n      } catch (error) {\n        return { id: localId, e: error };\n      }\n    };\n    this._getRemote = (dst, action, arg, timeout) => new Promise((resolve, reject) => {\n      const tid = this.transactions.new(resolve, reject, timeout);\n      this.log('Tx', 'get', 0, dst, action, arg, tid);\n      this.port.postMessage({ t: 'get', dst, action, arg, tid, timeout });\n    });\n        /**\n         * localId is the id of the current node\n         * localId will be set to 0 if called locally\n         * localId will be set to the node's global id if called from some other node\n         */\n    this.get = async (dst, action, arg, timeout = DEFAULT_TIMEOUT) => {\n      return (dst === 0)\n                ? [await this._getLocal(0, 0, action, arg)]\n                : await this._getRemote(dst, action, arg, timeout);\n    };\n    this.disconnectListener = (port) => {\n      this.onClientDisconnect && this.onClientDisconnect();\n    };\n        /**\n         * Although client nodes don't include a src id when sending messsages,\n         * because it is the bp's duty to populate the src id,\n         * incoming messages MUST have a src id.\n         * t is the message class\n         * If a client node receives a message, it must be an intended destination\n         */\n    this.messageListener = ({ src, dst, t, action, arg, tid, res }) => {\n      switch (t) {\n        case 'msg':\n          this.log('Rx', 'msg', src, dst, action, arg);\n          this.actionHandler(action, arg, src);\n          break;\n        case 'get':\n          this.log('Rx', 'get', src, dst, action, arg, tid);\n          this._getLocal(dst, src, action, arg)\n                        .then((res) => {\n                          try {\n                            this.log('Tx', 'rsp', src, dst, action, res, tid);\n                            this.port.postMessage({ t: 'rsp', src: dst, dst: src, action, tid, res });\n                          } catch (e) { } // the port may disconnect if the user navigated to a new page\n                        }).catch((e) => {\n                          try {\n                            this.log('Tx', 'rsp', src, dst, action, res, tid);\n                            this.port.postMessage({ t: 'rsp', src: dst, dst: src, action, tid, res: { e } });\n                          } catch (e) { }\n                        });\n          break;\n        case 'rsp':\n          this.log('Rx', 'rsp', src, dst, action, res, tid);\n          this.transactions.complete(tid, res);\n          break;\n        default:\n          console.error(`ERROR: Invalid message class: ${t}`);\n          break;\n      }\n    };\n  }\n}\nconst node = new Client();\nconst init = node.init;\nconst msg = node.msg;\nconst get = node.get;\nexport { init, msg, get };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/mosi/client.js\n// module id = 5\n// module chunks = 0 1 2 3 4","// TODO: at some point remove this polyfill or if an npm package is released\n// use it, instead of a random github repo\nif (SAKA_PLATFORM === 'chrome') {\n  require('webextension-polyfill/dist/browser-polyfill')\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/browser_polyfill.js",";\nexport const DEFAULT_TIMEOUT = 5000;\nexport class Transactions {\n  constructor () {\n    this.tid = 0;\n    this.transactions = {};\n    this.new = (resolve, reject, timeout) => {\n      const tid = ++this.tid;\n      const timer = setTimeout(() => {\n        delete this.transactions[tid];\n        reject(`Transaction ${tid} timed out.`);\n      }, timeout);\n      this.transactions[tid] = { resolve, reject, timer };\n      return tid;\n    };\n    this.complete = (tid, res) => {\n            // The transaction may have already timed out, so check if it still exists\n      const transaction = this.transactions[tid];\n      if (transaction) {\n        transaction.resolve(res);\n        clearTimeout(transaction.timer);\n        delete this.transactions[tid];\n      }\n    };\n  }\n}\nexport class Node {\n  constructor () {\n    this.actionHandler = (action, arg, src) => {\n      const handler = this.actions[action];\n      if (handler) { return handler(arg, src); }\n      throw Error(`No handler for action ${action}`);\n    };\n    this.initLogging = (log) => {\n      this.log = log\n                ? (tx_or_rx, type, src, dst, action, arg_or_res, tid) => {\n                  const arg_str = type === 'rsp' ? 'res' : 'arg';\n                  const tid_str = tid === undefined ? '' : `:${tid}`;\n                  console.log(`%c${tx_or_rx}%c[%c${type}%c${tid_str}](${src} -> ${dst}) :: %c${action}%c, ${arg_str}=`, `color: ${tx_or_rx === 'Tx' ? 'green' : 'red'}`, 'color: auto', `color: ${type === 'get' ? 'blueviolet' : type === 'msg' ? 'blue' : 'brown'}`, 'color: auto', 'color: teal', 'color: auto', arg_or_res);\n                }\n                : () => { };\n    };\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/mosi/node.js\n// module id = 7\n// module chunks = 0 1 2 3 4","/* webextension-polyfill - v0.1.0 - Wed Aug 23 2017 22:58:20 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (typeof browser === \"undefined\") {\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = () => {\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"export\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"import\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"downloads\": {\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getBrowserInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.rejection\n     *        The promise's rejection function.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = promise => {\n      return (...callbackArgs) => {\n        if (chrome.runtime.lastError) {\n          promise.reject(chrome.runtime.lastError);\n        } else if (callbackArgs.length === 1) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          target[name](...args, makeCallback({resolve, reject}));\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the orginal method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n\n      let handlers = {\n        has(target, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(target, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(target, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(target, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(target, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      return new Proxy(target, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let result = listener(message, sender);\n\n        if (isThenable(result)) {\n          result.then(sendResponse, error => {\n            console.error(error);\n            sendResponse(error);\n          });\n\n          return true;\n        } else if (result !== undefined) {\n          sendResponse(result);\n        }\n      };\n    });\n\n    const staticWrappers = {\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n      },\n    };\n\n    return wrapObject(chrome, staticWrappers, apiMetadata);\n  };\n\n  window.browser = wrapAPIs();\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/webextension-polyfill/dist/browser-polyfill.js\n// module id = 8\n// module chunks = 0 1 2 3 4","/** Returns the _positive_ modulus */\nexport function posMod (n, m) {\n  return (n % m + m) % m\n}\n\nexport function getAttributes (object, keys) {\n  const output = {}\n  keys.forEach(key => {\n    if (object.hasOwnProperty(key)) {\n      output[key] = object[key]\n    } else {\n      throw Error(`object has no attribute ${key}`)\n    }\n  })\n  return output\n}\n\nexport function objectMap (object, map) {\n  const out = {}\n  Object.entries(object).forEach(([attribute, value]) => {\n    out[attribute] = map(value)\n  })\n  return out\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/util.js","module.exports = {\"Backquote\":{\"value\":\"`\",\"shift\":\"~\"},\"Backslash\":{\"value\":\"\\\\\",\"shift\":\"|\"},\"BracketLeft\":{\"value\":\"[\",\"shift\":\"{\"},\"BracketRight\":{\"value\":\"]\",\"shift\":\"}\"},\"Comma\":{\"value\":\",\",\"shift\":\"<\"},\"Digit0\":{\"value\":\"0\",\"shift\":\")\"},\"Digit1\":{\"value\":\"1\",\"shift\":\"!\"},\"Digit2\":{\"value\":\"2\",\"shift\":\"@\"},\"Digit3\":{\"value\":\"3\",\"shift\":\"#\"},\"Digit4\":{\"value\":\"4\",\"shift\":\"$\"},\"Digit5\":{\"value\":\"5\",\"shift\":\"%\"},\"Digit6\":{\"value\":\"6\",\"shift\":\"^\"},\"Digit7\":{\"value\":\"7\",\"shift\":\"&\"},\"Digit8\":{\"value\":\"8\",\"shift\":\"*\"},\"Digit9\":{\"value\":\"9\",\"shift\":\"(\"},\"Equal\":{\"value\":\"=\",\"shift\":\"+\"},\"IntlBackslash\":{\"value\":\"\\\\\",\"shift\":\"|\",\"international\":true},\"IntlRo\":{\"value\":\"\\\\\",\"shift\":\"\",\"international\":true},\"IntlYen\":{\"value\":\"\",\"shift\":\"\",\"value2\":\"\\\\\",\"shift2\":\"/\",\"international\":true},\"KeyA\":{\"value\":\"a\",\"shift\":\"A\"},\"KeyB\":{\"value\":\"b\",\"shift\":\"B\"},\"KeyC\":{\"value\":\"c\",\"shift\":\"C\"},\"KeyD\":{\"value\":\"d\",\"shift\":\"D\"},\"KeyE\":{\"value\":\"e\",\"shift\":\"E\"},\"KeyF\":{\"value\":\"f\",\"shift\":\"F\"},\"KeyG\":{\"value\":\"g\",\"shift\":\"G\"},\"KeyH\":{\"value\":\"h\",\"shift\":\"H\"},\"KeyI\":{\"value\":\"i\",\"shift\":\"I\"},\"KeyJ\":{\"value\":\"j\",\"shift\":\"J\"},\"KeyK\":{\"value\":\"k\",\"shift\":\"K\"},\"KeyL\":{\"value\":\"l\",\"shift\":\"L\"},\"KeyM\":{\"value\":\"m\",\"shift\":\"M\"},\"KeyN\":{\"value\":\"n\",\"shift\":\"N\"},\"KeyO\":{\"value\":\"o\",\"shift\":\"O\"},\"KeyP\":{\"value\":\"p\",\"shift\":\"P\"},\"KeyQ\":{\"value\":\"q\",\"shift\":\"Q\"},\"KeyR\":{\"value\":\"r\",\"shift\":\"R\"},\"KeyS\":{\"value\":\"s\",\"shift\":\"S\"},\"KeyT\":{\"value\":\"t\",\"shift\":\"T\"},\"KeyU\":{\"value\":\"u\",\"shift\":\"U\"},\"KeyV\":{\"value\":\"v\",\"shift\":\"V\"},\"KeyW\":{\"value\":\"w\",\"shift\":\"W\"},\"KeyX\":{\"value\":\"x\",\"shift\":\"X\"},\"KeyY\":{\"value\":\"y\",\"shift\":\"Y\"},\"KeyZ\":{\"value\":\"z\",\"shift\":\"Z\"},\"Minus\":{\"value\":\"-\",\"shift\":\"_\"},\"Period\":{\"value\":\".\",\"shift\":\">\"},\"Quote\":{\"value\":\"'\",\"shift\":\"\\\"\"},\"Semicolon\":{\"value\":\";\",\"shift\":\":\"},\"Slash\":{\"value\":\"/\",\"shift\":\"?\"},\"Space\":{\"value\":\"Space\",\"shift\":\"Space\"},\"Tab\":{\"value\":\"Tab\",\"shift\":\"Tab\"},\"CapsLock\":{\"value\":\"CapsLock\",\"shift\":\"CapsLock\"},\"Escape\":{\"value\":\"Escape\",\"shift\":\"Escape\"},\"Backspace\":{\"value\":\"Backspace\",\"shift\":\"Backspace\"},\"ArrowLeft\":{\"value\":\"ArrowLeft\",\"shift\":\"ArrowLeft\"},\"ArrowRight\":{\"value\":\"ArrowRight\",\"shift\":\"ArrowRight\"},\"ArrowUp\":{\"value\":\"ArrowUp\",\"shift\":\"ArrowUp\"},\"ArrowDown\":{\"value\":\"ArrowDown\",\"shift\":\"ArrowDown\"},\"ShiftLeft\":{\"value\":\"ShiftLeft\",\"shift\":\"ShiftLeft\"},\"ShiftRight\":{\"value\":\"ShiftRight\",\"shift\":\"ShiftRight\"},\"ControlLeft\":{\"value\":\"ControlLeft\",\"shift\":\"ControlLeft\"},\"AltLeft\":{\"value\":\"AltLeft\",\"shift\":\"AltLeft\"},\"AltRight\":{\"value\":\"AltRight\",\"shift\":\"AltRight\"},\"MetaLeft\":{\"value\":\"MetaLeft\",\"shift\":\"MetaLeft\"},\"MetaRight\":{\"value\":\"MetaRight\",\"shift\":\"MetaRight\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/lib/friendlyCodeStrings.json\n// module id = 10\n// module chunks = 0 1 2 3 4","import 'lib/browser_polyfill'\n\nexport const storageGet = browser.storage.local.get\nexport const storageSet = browser.storage.local.set\nexport const storageRemove = browser.storage.local.remove\nexport const storageClear = browser.storage.local.clear\n\nexport async function getAllActiveProfileOptions () {\n  const { activeProfiles } = await storageGet('activeProfiles')\n  const { options } = await storageGet('options')\n  const activeOptions = {}\n  for (const [category, profile] of Object.entries(activeProfiles)) {\n    Object.assign(activeOptions, options[`${category}_${profile}`])\n  }\n  return activeOptions\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/storage/storage.js","import { validKeyboardEvent, keyboardEventString } from 'lib/keys'\n\n/**\n * Given an object mapping commands to their key bindings,\n * returns the trie representation.\n */\nexport function generateCommandTrie (commandMap) {\n  return JSONTrie(bindingsList(commandMap))\n}\n\n/**\n * Given an object mapping commands to their key bindings,\n * returns an array of (commands, binding).\n * A command may have more than one binding, or none at all.\n */\nfunction bindingsList (bindingsMap) {\n  const out = []\n  for (const [command, bindings] of Object.entries(bindingsMap)) {\n    if (bindings === undefined) {\n      throw Error(`A profile is missing bindings for command ${command}`)\n    }\n    for (const binding of bindings) {\n      const keySequence = binding.map(key => {\n        try {\n          validKeyboardEvent(key)\n        } catch (e) {\n          throw Error(`Invalid KeyboardEvent descriptor for ${command}`)\n        }\n        return keyboardEventString(key)\n      })\n      out.push([keySequence, command, binding])\n    }\n  }\n  return out\n}\n\n/**\n * Given an array of (command, binding),\n * returns the trie representation.\n */\nfunction JSONTrie (bindings) {\n  const trie = {}\n  bindings.forEach(([key, value, binding]) => {\n    addToTrie(trie, 0, key, value, binding)\n  })\n  return trie\n}\n\nfunction addToTrie (trie, i, key, value, binding) {\n  if (key.length === 0) {\n    throw Error(`${value} has a 0 length key binding`)\n  } else if (i === key.length - 1) {\n    if (trie.hasOwnProperty(key[i])) {\n      throw {\n        message: `${firstLeafValue(\n          trie[key[i]]\n        )} and ${value} have conflicting mapping`,\n        type: 'conflict',\n        command1: trie[key[i]],\n        command2: value\n      }\n    } else {\n      trie[key[i]] = value\n    }\n  } else {\n    if (trie.hasOwnProperty(key[i])) {\n      if (typeof trie[key[i]] === 'object') {\n        addToTrie(trie[key[i]], i + 1, key, value)\n      } else {\n        throw {\n          message: `${trie[key[i]]} and ${value} have conflicting prefix`,\n          type: 'conflict',\n          command1: trie[key[i]],\n          command2: value\n        }\n      }\n    } else {\n      addToTrie((trie[key[i]] = {}), i + 1, key, value)\n    }\n  }\n}\n\nfunction firstLeafValue (trie) {\n  return typeof trie === 'object'\n    ? firstLeafValue(trie[Object.keys(trie)[0]])\n    : trie\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/options/Keybindings/trie.js","import { generateCommandTrie } from './trie'\nimport { getAttributes } from 'lib/util'\nimport { setKeyboardSettings } from 'lib/keys'\n\nexport default (options, config) => {\n  const backgroundOptions = getAttributes(options, ['hintChars'])\n  const clientOptions = getAttributes(options, [\n    'physicalKeys',\n    'ignoreModifierKeys'\n  ])\n  const errors = {}\n  if (options.hintChars.length < 2) {\n    errors.hintChars = 'A minimum of two hint characters must be specified'\n  }\n  setKeyboardSettings(options.physicalKeys, options.ignoreModifierKeys)\n  const keybindings = keybindingsPerMode(options, config)\n  Object.entries(keybindings).forEach(([mode, bindings]) => {\n    try {\n      clientOptions[\n        mode ? `${mode}Bindings` : 'bindings'\n      ] = generateCommandTrie(bindings)\n    } catch (e) {\n      if (e.type === 'conflict') {\n        errors[e.command1] = e.message\n        errors[e.command2] = e.message\n      } else throw e\n    }\n  })\n  return { backgroundOptions, clientOptions, errors }\n}\n\nfunction keybindingsPerMode (options, config) {\n  const keybindings = {}\n  config.forEach(item => {\n    if (item.type === 'keybinding') {\n      const { mode = 'command', key } = item\n      if (keybindings[mode]) {\n        keybindings[mode][key] = options[key]\n      } else {\n        keybindings[mode] = { [key]: options[key] }\n      }\n    }\n  })\n  return keybindings\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/options/Keybindings/index.js","import { getAttributes } from 'lib/util'\n\nexport default (options, config) => {\n  const backgroundOptions = {}\n  const clientOptions = getAttributes(options, [\n    'hintFontSize',\n    'hintUseTargetSize',\n    'hintCSS',\n    'hintNormalCharCSS',\n    'hintActiveCharCSS',\n    'hintHorizontalPlacement',\n    'hintVerticalPlacement'\n  ])\n  const errors = {}\n  if (options.hintUseCustomCSS) {\n    clientOptions.hintCSS = `all: initial; position: absolute; z-index: 999999999999; ${options.hintCSS}`\n  } else {\n    clientOptions.hintCSS = generateHintCSS(options)\n    clientOptions.hintNormalCharCSS = ''\n    clientOptions.hintActiveCharCSS = 'opacity: 0.5'\n  }\n  return { backgroundOptions, clientOptions, errors }\n}\n\n/**\n * Given input settings parameters, generates the CSS used to style link hints\n */\nfunction generateHintCSS ({\n  hintOpacity,\n  hintFontFamily,\n  hintFontWeight,\n  hintHorizontalPadding,\n  hintVerticalPadding,\n  hintBorderWidth,\n  hintFontSize,\n  hintTextColor,\n  hintBackgroundColor,\n  hintBorderColor,\n  hintShadow,\n  hintBorderRadius,\n  hintHorizontalPlacement,\n  hintVerticalPlacement,\n  hintHorizontalTranslation,\n  hintVerticalTranslation\n}) {\n  const translationX =\n    hintHorizontalTranslation +\n    (hintHorizontalPlacement === 'left'\n      ? 0\n      : hintHorizontalPlacement === 'right' ? -100 : -50)\n  const translationY =\n    hintVerticalTranslation +\n    (hintVerticalPlacement === 'top'\n      ? 0\n      : hintVerticalPlacement === 'bottom' ? -100 : -50)\n  return `all: initial;\nposition: absolute;\nz-index: 2147483647;\nopacity: ${hintOpacity};\nfont-family: ${hintFontFamily};\nfont-weight: ${hintFontWeight};\npadding: ${hintVerticalPadding}rem ${hintHorizontalPadding}rem;\nborder: ${hintBorderWidth}px solid;\ntext-align: center;\ntext-decoration: none;\ntext-transform: uppercase;\nvertical-align: middle;\nfont-size: ${hintFontSize}px;\ncolor: ${hintTextColor};\nbackground-color: ${hintBackgroundColor};\nborder-color: ${hintBorderColor};\n${hintShadow\n    ? 'box-shadow: 0 3px 1px -2px rgba(0,0,0,.2), 0 2px 2px 0 rgba(0,0,0,.14), 0 1px 5px 0 rgba(0,0,0,.12);'\n    : ''}\nborder-radius: ${hintBorderRadius}px;\ntransform: translate3d(${translationX}%, ${translationY}%, 0)`\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/options/Appearance/index.js","import { getAttributes } from 'lib/util'\n\nexport default (options, config) => {\n  const backgroundOptions = getAttributes(options, ['autoActivateHint'])\n  const clientOptions = getAttributes(options, [\n    'enabled',\n    'preventStealFocus',\n    'hintDetectByCursorStyle',\n    'smoothScroll',\n    'scrollStep'\n  ])\n  const errors = {}\n  return { backgroundOptions, clientOptions, errors }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/options/General/index.js","import transformGeneral from 'options/General'\nimport transformKeybindings from 'options/Keybindings'\nimport transformAppearance from 'options/Appearance'\nconst transforms = {\n  General: transformGeneral,\n  Keybindings: transformKeybindings,\n  Appearance: transformAppearance\n}\nexport const categories = Object.keys(transforms)\n\n/**\n * Given a key-value map of options, applies and merges each per-category transform.\n * @param {{ [key: string]: any }} allOptions\n * @returns {{ backgroundOptions: { [key: string]: any }, clientOptions: { [key: string]: any }, errors: { [key: string]: any } }}\n */\nexport default function transformOptions (allOptions, config) {\n  let allBackgroundOptions = {}\n  let allClientOptions = {}\n  let allErrors = {}\n  Object.entries(transforms).forEach(([category, transform]) => {\n    const { clientOptions, backgroundOptions, errors } = transform(\n      allOptions,\n      config[category]\n    )\n    Object.assign(allClientOptions, clientOptions)\n    Object.assign(allBackgroundOptions, backgroundOptions)\n    Object.assign(allErrors, errors)\n  })\n  return {\n    backgroundOptions: allBackgroundOptions,\n    clientOptions: allClientOptions,\n    errors: allErrors\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/storage/transform.js","import {\n  storageGet,\n  storageSet,\n  storageRemove,\n  storageClear\n} from 'storage/storage'\nimport { msg } from 'mosi/client'\nimport { categories as installCategories } from 'storage/transform'\nimport { downloadJSON } from 'lib/dom'\nimport compareVersions from 'compare-versions'\n\n// TODO: test this code, lots of room for error, should really have unit tests\n\nexport async function storageInstallProcedure () {\n  try {\n    await storageSet({ ready: false })\n    await createCategories()\n    await createConfig()\n    if (SAKA_DEBUG) await validateConfig()\n    await createBuiltInProfiles()\n    await createCustomProfiles()\n    await createActiveProfiles()\n    await createBuiltInOptions()\n    await storageSet({ ready: true })\n  } catch (e) {\n    console.error(\n      'FATAL ERROR: INSTALLATION FAILED. DELETE THEN REINSTALL THE EXTENSION.',\n      e\n    )\n  }\n}\n\nexport async function storageUpdateProcedure (previousVersion) {\n  try {\n    // order matters: e.g. you must delete the old built-in options using the\n    // built-in profiles already in storage, not the built-in profiles in the update\n    await storageSet({ ready: false })\n    if (compareVersions(previousVersion, '1.16') <= 0) {\n      await storageClear()\n      await storageInstallProcedure()\n    } else {\n      await deleteBuiltInOptions()\n      await deleteBuiltInProfiles()\n      await deleteConfig()\n      await deleteCategories()\n      await createCategories()\n      await createConfig()\n      if (SAKA_DEBUG) await validateConfig()\n      await createBuiltInProfiles()\n      await renameCustomProfilesAndOptions() // if a new built-in profile 'steals' the name of an existing custom profile\n      await correctActiveProfiles() // if the active profile is a deleted built-in profile\n      await createBuiltInOptions()\n      await correctCustomOptions()\n    }\n    await storageSet({ ready: true })\n  } catch (e) {\n    console.error(\n      'FATAL ERROR: UPDATE FAILED. DELETE THEN REINSTALL THE EXTENSION.',\n      e\n    )\n  }\n}\n\n// TODO: proper import validation\nexport async function storeageImportProcedure () {\n  const input = document.createElement('input')\n  input.setAttribute('type', 'file')\n  input.setAttribute('accept', '.json')\n  input.addEventListener('change', e => {\n    const reader = new FileReader()\n    reader.onload = async () => {\n      await storageResetProcedure()\n      const { customProfiles, options } = await storageGet([\n        'customProfiles',\n        'options'\n      ])\n      const { activeProfiles, profiles } = JSON.parse(reader.result)\n      for (const category in profiles) {\n        for (const profile in profiles[category]) {\n          customProfiles[category].push(profile)\n          options[`${category}_${profile}`] = profiles[category][profile]\n        }\n      }\n      await storageSet({ customProfiles, activeProfiles, options })\n      msg('options_page', 'RERENDER')\n    }\n    reader.readAsText(e.target.files[0])\n  })\n  input.click()\n}\n\nexport async function storageExportProcedure () {\n  const { customProfiles, activeProfiles, options } = await storageGet([\n    'customProfiles',\n    'activeProfiles',\n    'options'\n  ])\n  const profiles = {}\n  for (const category in customProfiles) {\n    profiles[category] = {}\n    customProfiles[category].forEach(profile => {\n      profiles[category][profile] = options[`${category}_${profile}`]\n    })\n  }\n  await downloadJSON({ activeProfiles, profiles }, 'saka_key_config.json')\n}\n\nexport async function storageResetProcedure () {\n  await storageClear()\n  await storageInstallProcedure()\n  msg('options_page', 'RERENDER')\n}\n\nasync function createCategories () {\n  await storageSet({ categories: installCategories })\n}\n\nasync function createConfig () {\n  const { categories } = await storageGet('categories')\n  const config = {}\n  for (const category of categories) {\n    const request = await fetch(`/config_${category}.json`)\n    const result = await request.json()\n    config[category] = result.options\n  }\n  await storageSet({ config })\n}\n\n// TODO: define a per-type validation function\nasync function validateConfig () {\n  const { config } = await storageGet('config')\n  const allKeys = {}\n  for (const [category, _config] of Object.entries(config)) {\n    for (const item of _config) {\n      if (!item.hasOwnProperty('type')) {\n        throw Error(\n          `Config validation failed: item ${category}:${item.key ||\n            '[no key]'} has no type`,\n          item\n        )\n      }\n      if (item.hasOwnProperty('key')) {\n        if (allKeys.hasOwnProperty(item.key)) {\n          throw Error(\n            `Config validation failed: two items share the key ${item.key}`\n          )\n        } else {\n          allKeys[item.key] = true\n        }\n        if (!item.hasOwnProperty('default')) {\n          throw Error(\n            `Config validation failed: no default value for key ${item.key}`\n          )\n        }\n      }\n    }\n  }\n}\n\nasync function createBuiltInProfiles () {\n  const { categories } = await storageGet('categories')\n  const builtInProfiles = {}\n  for (const category of categories) {\n    const request = await fetch(`/default_${category}.json`)\n    const { profiles } = await request.json()\n    builtInProfiles[category] = profiles.map(profile => profile.name)\n  }\n  await storageSet({ builtInProfiles })\n}\n\nasync function createCustomProfiles () {\n  const { categories } = await storageGet('categories')\n  const customProfiles = {}\n  for (const category of categories) {\n    customProfiles[category] = []\n  }\n  await storageSet({ customProfiles })\n}\n\nasync function createActiveProfiles () {\n  const { categories } = await storageGet('categories')\n  const activeProfiles = {}\n  for (const category of categories) {\n    activeProfiles[category] = 'default'\n  }\n  await storageSet({ activeProfiles })\n}\n\n/**\n * If options don't exist, creates them using the built-in profiles.\n * If options exist, adds built-in profile options.\n */\nasync function createBuiltInOptions () {\n  const { options = {} } = await storageGet('options')\n  const { categories } = await storageGet('categories')\n  for (const category of categories) {\n    const request = await fetch(`/default_${category}.json`)\n    const { profiles } = await request.json()\n    for (const profile of profiles) {\n      options[`${category}_${profile.name}`] = profile.options\n    }\n  }\n  await storageSet({ options })\n}\n\nasync function deleteBuiltInOptions () {\n  const { categories, options, builtInProfiles } = await storageGet([\n    'categories',\n    'options',\n    'builtInProfiles'\n  ])\n  for (const category of categories) {\n    for (const profile of builtInProfiles[category]) {\n      delete options[`${category}_${profile}`]\n    }\n  }\n  await storageSet({ options })\n}\n\nasync function deleteBuiltInProfiles () {\n  await storageRemove('builtInProfiles')\n}\n\nasync function deleteConfig () {\n  await storageRemove('config')\n}\n\n/**\n * Accounts for the case where a built-in profile introduced in an update conflicts with\n * a custom profile already installed. Renames the custom profile, active profile, and action\n * if a conflic is detected.\n */\nasync function renameCustomProfilesAndOptions () {\n  const {\n    categories,\n    customProfiles,\n    builtInProfiles,\n    activeProfiles,\n    options\n  } = await storageGet([\n    'categories',\n    'customProfiles',\n    'builtInProfiles',\n    'activeProfiles',\n    'options'\n  ])\n  for (const category of categories) {\n    const _builtInProfiles = builtInProfiles[category]\n    const _customProfiles = customProfiles[category]\n    const _activeProfile = activeProfiles[category]\n    _customProfiles.forEach((customProfile, i) => {\n      if (_builtInProfiles.indexOf(customProfile) !== -1) {\n        // rename custom profile\n        const newProfileName = `${customProfile}_renamed_${Date.now()}`\n        _customProfiles[i] = newProfileName\n        // rename active profile\n        if (_activeProfile === customProfile) {\n          activeProfiles[category] = newProfileName\n        }\n        // rename options\n        options[`${category}_${newProfileName}`] =\n          options[`${category}_${customProfile}`]\n        delete options[`${category}_${customProfile}`]\n      }\n    })\n  }\n  await storageSet({ customProfiles, activeProfiles, options })\n}\n\nasync function deleteCategories () {\n  await storageRemove('categories')\n}\n/**\n * Accounts for the case where the active profile has been deleted\n */\nasync function correctActiveProfiles () {\n  const {\n    categories,\n    activeProfiles,\n    builtInProfiles,\n    customProfiles\n  } = await storageGet([\n    'categories',\n    'activeProfiles',\n    'builtInProfiles',\n    'customProfiles'\n  ])\n  for (const category of categories) {\n    const profiles = [...builtInProfiles[category], ...customProfiles[category]]\n    if (profiles.indexOf(activeProfiles[category]) === -1) {\n      activeProfiles[category] = 'default'\n    }\n  }\n  await storageSet({ activeProfiles })\n}\n\nasync function correctCustomOptions () {\n  const { config, options, categories, customProfiles } = await storageGet([\n    'config',\n    'options',\n    'categories',\n    'customProfiles'\n  ])\n  for (const category of categories) {\n    for (const profile of customProfiles[category]) {\n      const key = `${category}_${profile}`\n      options[key] = correctedOptions(options[key], config[category])\n    }\n  }\n  await storageSet({ options })\n}\n\nfunction correctedOptions (options, config) {\n  const newOptions = {}\n  for (const item of config) {\n    newOptions[item.key] = correctValue(options[item.key], item)\n  }\n  return newOptions\n}\n\n/**\n * If the value conforms to the constraints defined in the config file,\n * returns the value unchanged. Otherwise returns the default value for the option.\n */\nfunction correctValue (value, configItem) {\n  // TODO\n  return value === undefined ? configItem.default : value\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/storage/procedures.js","/* global define */\n(function (root, factory) {\n    /* istanbul ignore next */\n    if (typeof define === 'function' && define.amd) {\n        define([], factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory();\n    } else {\n        root.compareVersions = factory();\n    }\n}(this, function () {\n\n    var semver = /^v?(?:\\d+)(\\.(?:[x*]|\\d+)(\\.(?:[x*]|\\d+)(?:-[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\n    var patch = /-([0-9A-Za-z-.]+)/;\n\n    function split(v) {\n        var temp = v.replace(/^v/, '').split('.');\n        var arr = temp.splice(0, 2);\n        arr.push(temp.join('.'));\n        return arr;\n    }\n\n    function tryParse(v) {\n        return isNaN(Number(v)) ? v : Number(v);\n    }\n\n    function validate(version) {\n        if (typeof version !== 'string') {\n            throw new TypeError('Invalid argument expected string');\n        }\n        if (!semver.test(version)) {\n            throw new Error('Invalid argument not valid semver');\n        }\n    }\n\n    return function compareVersions(v1, v2) {\n        [v1, v2].forEach(validate);\n\n        var s1 = split(v1);\n        var s2 = split(v2);\n\n        for (var i = 0; i < 3; i++) {\n            var n1 = parseInt(s1[i] || 0, 10);\n            var n2 = parseInt(s2[i] || 0, 10);\n\n            if (n1 > n2) return 1;\n            if (n2 > n1) return -1;\n        }\n\n        if ([s1[2], s2[2]].every(patch.test.bind(patch))) {\n            var p1 = patch.exec(s1[2])[1].split('.').map(tryParse);\n            var p2 = patch.exec(s2[2])[1].split('.').map(tryParse);\n\n            for (i = 0; i < Math.max(p1.length, p2.length); i++) {\n                if (p1[i] === undefined || typeof p2[i] === 'string' && typeof p1[i] === 'number') return -1;\n                if (p2[i] === undefined || typeof p1[i] === 'string' && typeof p2[i] === 'number') return 1;\n\n                if (p1[i] > p2[i]) return 1;\n                if (p2[i] > p1[i]) return -1;\n            }\n        } else if ([s1[2], s2[2]].some(patch.test.bind(patch))) {\n            return patch.test(s1[2]) ? -1 : 1;\n        }\n\n        return 0;\n    };\n\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/compare-versions/index.js\n// module id = 31\n// module chunks = 0 3","import { msg, meta } from 'mosi/core'\nimport { getAllActiveProfileOptions, storageGet } from 'storage/storage'\nimport transformOptions from 'storage/transform'\nimport {\n  storageInstallProcedure,\n  storageUpdateProcedure\n} from 'storage/procedures'\n\nexport let modes = {}\n\nconst defaultModeObject = {\n  onOptionsChange: () => {},\n  messages: {}\n}\n\nexport function initModes (availableModes, actions) {\n  modes = availableModes\n  Object.entries(availableModes).map(([name, mode]) => {\n    modes[name] = Object.assign({}, defaultModeObject, mode)\n    Object.assign(actions, modes[name].messages)\n  })\n}\n\nexport async function loadClient (_, src) {\n  const { sender: { frameId, tab: { index: tabIndex, id: tabId } } } = meta(src)\n  // tabIndex === -1 indicates the tab is preloaded but not a full tab\n  // attempting to execute into it is an error\n  // http://stackoverflow.com/questions/43665470/cannot-call-chrome-tabs-executescript-into-preloaded-tab-is-this-a-bug-in-chr\n  if (tabIndex === -1) {\n    if (SAKA_DEBUG) {\n      console.log(\n        `NOT loading client into preloaded tab: frame: ${frameId}, tab: ${tabId}`\n      )\n    }\n  } else {\n    if (SAKA_DEBUG) {\n      console.log(`Loading client: frame: ${frameId}, tab: ${tabId}`)\n    }\n    await browser.tabs.executeScript(tabId, {\n      file: '/content_script.js',\n      frameId,\n      runAt: 'document_start',\n      matchAboutBlank: true\n    })\n  }\n}\n\n/** Reloads all Saka Clients, called on extension updates */\nexport async function reloadAllClients () {\n  const tabs = await browser.tabs.query({})\n  for (const tab of tabs) {\n    try {\n      browser.tabs.executeScript(tab.id, {\n        file: '/content_script_loader.js',\n        allFrames: true,\n        runAt: 'document_start',\n        matchAboutBlank: true\n      })\n    } catch (e) {}\n  }\n}\n\n// Requests for the full Saka Client by the client loaders of preloaded tabs are\n// denied because attempting to execute within them would cause errors.\n// http://stackoverflow.com/questions/43665470/cannot-call-chrome-tabs-executescript-into-preloaded-tab-is-this-a-bug-in-chr\n// Instead, the background page listens for the tabs.onReplaced event and executes\n// content_script_loader.js into all frames, which then launches another request for\n// the full Saka Client\nif (SAKA_PLATFORM === 'chrome') {\n  chrome.tabs.onReplaced.addListener((addedTabId, removedTabId) => {\n    if (SAKA_DEBUG) {\n      console.log(\n        `Tab id changed from ${removedTabId} to ${addedTabId}. Reloading content_script_loader.js`\n      )\n    }\n    browser.tabs.executeScript(addedTabId, {\n      file: '/content_script_loader.js',\n      allFrames: true,\n      runAt: 'document_start',\n      matchAboutBlank: true\n    })\n  })\n}\n\nlet cachedClientOptions\n\nexport function clientOptions (arg, src) {\n  msg(src, 'clientOptions', cachedClientOptions)\n}\n\nasync function onOptionsChange () {\n  if ((await storageGet('ready')).ready) {\n    const { backgroundOptions, clientOptions } = transformOptions(\n      await getAllActiveProfileOptions(),\n      (await storageGet('config')).config\n    )\n    Object.values(modes).forEach(mode => {\n      mode.onOptionsChange(backgroundOptions)\n    })\n    cachedClientOptions = clientOptions\n    msg('client', 'clientOptions', clientOptions)\n  }\n}\n\nchrome.storage.onChanged.addListener(onOptionsChange)\n\n/**\n * Sets up startup listener, sets up install listener, and executes setup routine\n * When an extension is installed, only the install listener is executed, not the\n * startup listener. The startup listener is called only when chrome is opened.\n * The install listener can be called for a number of reasons.\n * A setup action that should always run whenever the background page starts\n * should NOT be placed in the startup listener.\n */\nexport async function setup () {\n  await initInstallListeners()\n  await onOptionsChange()\n}\n\nfunction initInstallListeners () {\n  chrome.runtime.onInstalled.addListener(\n    async ({ reason, previousVersion }) => {\n      if (SAKA_DEBUG) console.log('install event: ' + reason)\n      switch (reason) {\n        case 'install':\n          await storageInstallProcedure()\n          await onOptionsChange()\n          await reloadAllClients()\n          chrome.tabs.create({ url: 'info.html' })\n          break\n        case 'update':\n          await storageUpdateProcedure(previousVersion)\n          await onOptionsChange()\n          await reloadAllClients()\n          // TODO: Replace with Notification\n          // chrome.tabs.create({ url: 'info.html' });\n          break\n        case 'chrome_update':\n        case 'shared_module_update':\n        default:\n          break\n      }\n    }\n  )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/background_page/modes.js","import { posMod } from 'lib/util'\n\n/** Activate the tab to the right of the active tab of the current window */\nexport async function nextTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  const nextTabId = tabs[posMod(activeTabIndex + 1, tabs.length)].id\n  await browser.tabs.update(nextTabId, { active: true })\n}\n\n/** Activate the tab to the left of the active tab of the current window */\nexport async function previousTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  const previousTabId = tabs[posMod(activeTabIndex - 1, tabs.length)].id\n  await browser.tabs.update(previousTabId, { active: true })\n}\n\n/** Activate the first tab of the current window */\nexport async function firstTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const firstTabId = tabs[0].id\n  await browser.tabs.update(firstTabId, { active: true })\n}\n\n/** Activate the last tab of the current window */\nexport async function lastTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const lastTabId = tabs[tabs.length - 1].id\n  await browser.tabs.update(lastTabId, { active: true })\n}\n\n/** Move the active tab of the current window left */\nexport async function moveTabLeft () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.move(tab.id, { index: tab.index - 1 })\n}\n\n/** Move the active tab of the current window right */\nexport async function moveTabRight () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  const nextTabIndex = posMod(activeTabIndex + 1, tabs.length)\n  await browser.tabs.move(tabs[activeTabIndex].id, { index: nextTabIndex })\n}\n\n/** Move the active tab of the current window to the far left */\nexport async function moveTabFirst () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.move(tab.id, { index: 0 })\n}\n\n/** Move the active tab of the current window to the far right */\nexport async function moveTabLast () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.move(tab.id, { index: -1 })\n}\n\n/** Close the active tab of the current window */\nexport async function closeTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.remove(tab.id)\n}\n\n/** Close all tabs of the current window except the active tab */\nexport async function closeOtherTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  await Promise.all(\n    tabs.map(async tab => {\n      if (!tab.active) await browser.tabs.remove(tab.id)\n    })\n  )\n}\n\n/** Close all tabs to the right of the active tab of the current window */\nexport async function closeRightTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  await Promise.all(\n    tabs.slice(activeTabIndex + 1).map(async tab => {\n      await browser.tabs.remove(tab.id)\n    })\n  )\n}\n\n/** Close all tabs to the left of the active tab of the current window */\nexport async function closeLeftTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  await Promise.all(\n    tabs.slice(0, activeTabIndex).map(async tab => {\n      await browser.tabs.remove(tab.id)\n    })\n  )\n}\n\n/** Create and activate a new tab */\nexport async function newTab () {\n  await browser.tabs.create({})\n}\n\n/** Reopen and activate the last closed tab */\nexport async function restoreTab () {\n  await browser.sessions.restore()\n}\n\n/** Duplicate and activate the active tab of the current window */\nexport async function duplicateTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.duplicate(tab.id)\n}\n\n/** Create a new window */\nexport async function newWindow () {\n  await browser.windows.create()\n}\n\n/** Create a new incognito window */\nexport async function newIncognitoWindow () {\n  await browser.windows.create({ incognito: true })\n}\n\n/** Activate the next window */\nexport async function switchWindow () {\n  // TODO: Implement\n  console.error('switchWindow not implemented')\n}\n\nlet zoomStep = 10 // for 10%\n\n/** Zoom in the active tab of the current window */\nexport async function zoomIn () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  const zoomFactor = await browser.tabs.getZoom()\n  await browser.tabs.setZoom(tab.id, Math.min(zoomFactor + zoomStep / 100, 3.0))\n}\n\n/** Zoom out the active tab of the current window */\nexport async function zoomOut () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  const zoomFactor = await browser.tabs.getZoom()\n  await browser.tabs.setZoom(tab.id, Math.max(zoomFactor - zoomStep / 100, 0.3))\n}\n\n/** Reset the zoom of the active tab of the current window */\nexport async function zoomReset () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.setZoom(tab.id, 0)\n}\n\n/** Refresh the active tab of the current window */\nexport async function refreshTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.reload(tab.id)\n}\n\n/** Refresh all tabs of the current window */\nexport async function refreshAllTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  await Promise.all(\n    tabs.map(async tab => {\n      await browser.tabs.reload(tab.id)\n    })\n  )\n}\n\n/** Hard refreshes the active tab of the current window */\nexport async function hardRefreshTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.reload(tab.id, { bypassCache: true })\n}\n\n/** Toggle the mute state of the active tab of the current window */\nexport async function toggleMuteTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.update(tab.id, { muted: !tab.mutedInfo.muted })\n}\n\nlet muted = false\n\n/** Mute all tabs of all windows */\nexport async function toggleMuteAllTabs () {\n  muted = !muted\n  const tabs = await browser.tabs.query({})\n  await Promise.all(\n    tabs.map(async tab => {\n      await browser.tabs.update(tab.id, { muted })\n    })\n  )\n}\n\n/** Toggle the pin state of the active tab of the current window */\nexport async function togglePinTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.update(tab.id, { pinned: !tab.pinned })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modes/command/background/commands/tab.js","/**\n * Returns true only if str is a valid url\n * @param {string} str\n */\nexport function isURL (str) {\n  try {\n    new URL(str)\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nexport function stripProtocol (url) {\n  return url.replace(/(^\\w+:|^)\\/\\//, '')\n}\n\nexport function stripWWW (url) {\n  return url.replace(/^www\\./, '')\n}\n\nexport function startsWithProtocol (str) {\n  return str.match(/(^\\w+:|^)\\/\\//) !== null\n}\n\nexport function startsWithWWW (str) {\n  return str.match(/^www\\./, '') !== null\n}\n\n/**\n * Based on https://github.com/1995eaton/chromium-vim/blob/aec10cf47943b4674a5bc92c46d3c3c138d3cba3/content_scripts/utils.js#L51\n */\nexport function searchURL (\n  query,\n  queryURLTemplate = 'https://www.google.com/search?q='\n) {\n  return isLikeURL(query)\n    ? (!/^[a-zA-Z-]+:/.test(query) ? 'http://' : '') + query\n    : searchEngineQueryURL(query, queryURLTemplate)\n}\n\n/**\n * Based on https://github.com/1995eaton/chromium-vim/blob/aec10cf47943b4674a5bc92c46d3c3c138d3cba3/content_scripts/utils.js#L45\n */\nexport function searchEngineQueryURL (query, queryURLTemplate) {\n  const encodedSearchQuery = encodeURIComponent(query)\n  const i = queryURLTemplate.lastIndexOf('%s')\n  return i < 0\n    ? `${queryURLTemplate}${encodedSearchQuery}`\n    : `${queryURLTemplate.slice(\n      0,\n      i\n    )}${encodedSearchQuery}${queryURLTemplate.slice(i + 2)}`\n}\n\n/**\n * Returns true if the text is a valid URL (including protocol, e.g. http://hello)\n * or probably corresponds to a valid URL (e.g. google.com)\n * Based on https://github.com/1995eaton/chromium-vim/blob/aec10cf47943b4674a5bc92c46d3c3c138d3cba3/content_scripts/utils.js#L59\n */\nexport function isLikeURL (url) {\n  url = url.trim()\n  if (url.indexOf(' ') !== -1) {\n    return false\n  }\n  if (url.search(/^(about|file):[^:]/) !== -1) {\n    return true\n  }\n  const protocol = (url.match(/^([a-zA-Z-]+:)[^:]/) || [''])[0].slice(0, -1)\n  const protocolMatch = isProtocol(protocol)\n  if (protocolMatch) {\n    url = url.replace(/^[a-zA-Z-]+:\\/*/, '')\n  }\n  const hasPath = /.*[a-zA-Z].*\\//.test(url)\n  url = url.replace(/(:[0-9]+)?([#/].*|$)/g, '').split('.')\n  if (protocolMatch && /^[a-zA-Z0-9@!]+$/.test(url)) {\n    return true\n  }\n  if (protocol && !protocolMatch && protocol !== 'localhost:') {\n    return false\n  }\n  // IP addresses\n  const isIP = url.every(e => /^[0-9]+$/.test(e) && +e >= 0 && +e < 256)\n  if ((isIP && !protocol && url.length === 4) || (isIP && protocolMatch)) {\n    return true\n  }\n  return (\n    (url.every(e => /^[a-z0-9-]+$/i.test(e)) &&\n      (url.length > 1 && isTLD(url[url.length - 1]))) ||\n    (url.length === 1 && url[0] === 'localhost') ||\n    hasPath\n  )\n}\n\nconst knownTLDs = [\n  'abogado',\n  'ac',\n  'academy',\n  'accountants',\n  'active',\n  'actor',\n  'ad',\n  'adult',\n  'ae',\n  'aero',\n  'af',\n  'ag',\n  'agency',\n  'ai',\n  'airforce',\n  'al',\n  'allfinanz',\n  'alsace',\n  'am',\n  'amsterdam',\n  'an',\n  'android',\n  'ao',\n  'aq',\n  'aquarelle',\n  'ar',\n  'archi',\n  'army',\n  'arpa',\n  'as',\n  'asia',\n  'associates',\n  'at',\n  'attorney',\n  'au',\n  'auction',\n  'audio',\n  'autos',\n  'aw',\n  'ax',\n  'axa',\n  'az',\n  'ba',\n  'band',\n  'bank',\n  'bar',\n  'barclaycard',\n  'barclays',\n  'bargains',\n  'bayern',\n  'bb',\n  'bd',\n  'be',\n  'beer',\n  'berlin',\n  'best',\n  'bf',\n  'bg',\n  'bh',\n  'bi',\n  'bid',\n  'bike',\n  'bio',\n  'biz',\n  'bj',\n  'black',\n  'blackfriday',\n  'bloomberg',\n  'blue',\n  'bm',\n  'bmw',\n  'bn',\n  'bnpparibas',\n  'bo',\n  'boo',\n  'boutique',\n  'br',\n  'brussels',\n  'bs',\n  'bt',\n  'budapest',\n  'build',\n  'builders',\n  'business',\n  'buzz',\n  'bv',\n  'bw',\n  'by',\n  'bz',\n  'bzh',\n  'ca',\n  'cab',\n  'cal',\n  'camera',\n  'camp',\n  'cancerresearch',\n  'capetown',\n  'capital',\n  'caravan',\n  'cards',\n  'care',\n  'career',\n  'careers',\n  'cartier',\n  'casa',\n  'cash',\n  'cat',\n  'catering',\n  'cc',\n  'cd',\n  'center',\n  'ceo',\n  'cern',\n  'cf',\n  'cg',\n  'ch',\n  'channel',\n  'cheap',\n  'christmas',\n  'chrome',\n  'church',\n  'ci',\n  'citic',\n  'city',\n  'ck',\n  'cl',\n  'claims',\n  'cleaning',\n  'click',\n  'clinic',\n  'clothing',\n  'club',\n  'cm',\n  'cn',\n  'co',\n  'coach',\n  'codes',\n  'coffee',\n  'college',\n  'cologne',\n  'com',\n  'community',\n  'company',\n  'computer',\n  'condos',\n  'construction',\n  'consulting',\n  'contractors',\n  'cooking',\n  'cool',\n  'coop',\n  'country',\n  'cr',\n  'credit',\n  'creditcard',\n  'cricket',\n  'crs',\n  'cruises',\n  'cu',\n  'cuisinella',\n  'cv',\n  'cw',\n  'cx',\n  'cy',\n  'cymru',\n  'cz',\n  'dabur',\n  'dad',\n  'dance',\n  'dating',\n  'day',\n  'dclk',\n  'de',\n  'deals',\n  'degree',\n  'delivery',\n  'democrat',\n  'dental',\n  'dentist',\n  'desi',\n  'design',\n  'dev',\n  'diamonds',\n  'diet',\n  'digital',\n  'direct',\n  'directory',\n  'discount',\n  'dj',\n  'dk',\n  'dm',\n  'dnp',\n  'do',\n  'docs',\n  'domains',\n  'doosan',\n  'durban',\n  'dvag',\n  'dz',\n  'eat',\n  'ec',\n  'edu',\n  'education',\n  'ee',\n  'eg',\n  'email',\n  'emerck',\n  'energy',\n  'engineer',\n  'engineering',\n  'enterprises',\n  'equipment',\n  'er',\n  'es',\n  'esq',\n  'estate',\n  'et',\n  'eu',\n  'eurovision',\n  'eus',\n  'events',\n  'everbank',\n  'exchange',\n  'expert',\n  'exposed',\n  'fail',\n  'farm',\n  'fashion',\n  'feedback',\n  'fi',\n  'finance',\n  'financial',\n  'firmdale',\n  'fish',\n  'fishing',\n  'fit',\n  'fitness',\n  'fj',\n  'fk',\n  'flights',\n  'florist',\n  'flowers',\n  'flsmidth',\n  'fly',\n  'fm',\n  'fo',\n  'foo',\n  'forsale',\n  'foundation',\n  'fr',\n  'frl',\n  'frogans',\n  'fund',\n  'furniture',\n  'futbol',\n  'ga',\n  'gal',\n  'gallery',\n  'garden',\n  'gb',\n  'gbiz',\n  'gd',\n  'ge',\n  'gent',\n  'gf',\n  'gg',\n  'ggee',\n  'gh',\n  'gi',\n  'gift',\n  'gifts',\n  'gives',\n  'gl',\n  'glass',\n  'gle',\n  'global',\n  'globo',\n  'gm',\n  'gmail',\n  'gmo',\n  'gmx',\n  'gn',\n  'goog',\n  'google',\n  'gop',\n  'gov',\n  'gp',\n  'gq',\n  'gr',\n  'graphics',\n  'gratis',\n  'green',\n  'gripe',\n  'gs',\n  'gt',\n  'gu',\n  'guide',\n  'guitars',\n  'guru',\n  'gw',\n  'gy',\n  'hamburg',\n  'hangout',\n  'haus',\n  'healthcare',\n  'help',\n  'here',\n  'hermes',\n  'hiphop',\n  'hiv',\n  'hk',\n  'hm',\n  'hn',\n  'holdings',\n  'holiday',\n  'homes',\n  'horse',\n  'host',\n  'hosting',\n  'house',\n  'how',\n  'hr',\n  'ht',\n  'hu',\n  'ibm',\n  'id',\n  'ie',\n  'ifm',\n  'il',\n  'im',\n  'immo',\n  'immobilien',\n  'in',\n  'industries',\n  'info',\n  'ing',\n  'ink',\n  'institute',\n  'insure',\n  'int',\n  'international',\n  'investments',\n  'io',\n  'iq',\n  'ir',\n  'irish',\n  'is',\n  'it',\n  'iwc',\n  'jcb',\n  'je',\n  'jetzt',\n  'jm',\n  'jo',\n  'jobs',\n  'joburg',\n  'jp',\n  'juegos',\n  'kaufen',\n  'kddi',\n  'ke',\n  'kg',\n  'kh',\n  'ki',\n  'kim',\n  'kitchen',\n  'kiwi',\n  'km',\n  'kn',\n  'koeln',\n  'kp',\n  'kr',\n  'krd',\n  'kred',\n  'kw',\n  'ky',\n  'kyoto',\n  'kz',\n  'la',\n  'lacaixa',\n  'land',\n  'lat',\n  'latrobe',\n  'lawyer',\n  'lb',\n  'lc',\n  'lds',\n  'lease',\n  'legal',\n  'lgbt',\n  'li',\n  'lidl',\n  'life',\n  'lighting',\n  'limited',\n  'limo',\n  'link',\n  'lk',\n  'loans',\n  'london',\n  'lotte',\n  'lotto',\n  'lr',\n  'ls',\n  'lt',\n  'ltda',\n  'lu',\n  'luxe',\n  'luxury',\n  'lv',\n  'ly',\n  'ma',\n  'madrid',\n  'maison',\n  'management',\n  'mango',\n  'market',\n  'marketing',\n  'marriott',\n  'mc',\n  'md',\n  'me',\n  'media',\n  'meet',\n  'melbourne',\n  'meme',\n  'memorial',\n  'menu',\n  'mg',\n  'mh',\n  'miami',\n  'mil',\n  'mini',\n  'mk',\n  'ml',\n  'mm',\n  'mn',\n  'mo',\n  'mobi',\n  'moda',\n  'moe',\n  'monash',\n  'money',\n  'mormon',\n  'mortgage',\n  'moscow',\n  'motorcycles',\n  'mov',\n  'mp',\n  'mq',\n  'mr',\n  'ms',\n  'mt',\n  'mu',\n  'museum',\n  'mv',\n  'mw',\n  'mx',\n  'my',\n  'mz',\n  'na',\n  'nagoya',\n  'name',\n  'navy',\n  'nc',\n  'ne',\n  'net',\n  'network',\n  'neustar',\n  'new',\n  'nexus',\n  'nf',\n  'ng',\n  'ngo',\n  'nhk',\n  'ni',\n  'ninja',\n  'nl',\n  'no',\n  'np',\n  'nr',\n  'nra',\n  'nrw',\n  'nu',\n  'nyc',\n  'nz',\n  'okinawa',\n  'om',\n  'one',\n  'ong',\n  'onl',\n  'ooo',\n  'org',\n  'organic',\n  'osaka',\n  'otsuka',\n  'ovh',\n  'pa',\n  'paris',\n  'partners',\n  'parts',\n  'party',\n  'pe',\n  'pf',\n  'pg',\n  'ph',\n  'pharmacy',\n  'photo',\n  'photography',\n  'photos',\n  'physio',\n  'pics',\n  'pictures',\n  'pink',\n  'pizza',\n  'pk',\n  'pl',\n  'place',\n  'plumbing',\n  'pm',\n  'pn',\n  'pohl',\n  'poker',\n  'porn',\n  'post',\n  'pr',\n  'praxi',\n  'press',\n  'pro',\n  'prod',\n  'productions',\n  'prof',\n  'properties',\n  'property',\n  'ps',\n  'pt',\n  'pub',\n  'pw',\n  'py',\n  'qa',\n  'qpon',\n  'quebec',\n  're',\n  'realtor',\n  'recipes',\n  'red',\n  'rehab',\n  'reise',\n  'reisen',\n  'reit',\n  'ren',\n  'rentals',\n  'repair',\n  'report',\n  'republican',\n  'rest',\n  'restaurant',\n  'reviews',\n  'rich',\n  'rio',\n  'rip',\n  'ro',\n  'rocks',\n  'rodeo',\n  'rs',\n  'rsvp',\n  'ru',\n  'ruhr',\n  'rw',\n  'ryukyu',\n  'sa',\n  'saarland',\n  'sale',\n  'samsung',\n  'sarl',\n  'sb',\n  'sc',\n  'sca',\n  'scb',\n  'schmidt',\n  'schule',\n  'schwarz',\n  'science',\n  'scot',\n  'sd',\n  'se',\n  'services',\n  'sew',\n  'sexy',\n  'sg',\n  'sh',\n  'shiksha',\n  'shoes',\n  'shriram',\n  'si',\n  'singles',\n  'sj',\n  'sk',\n  'sky',\n  'sl',\n  'sm',\n  'sn',\n  'so',\n  'social',\n  'software',\n  'sohu',\n  'solar',\n  'solutions',\n  'soy',\n  'space',\n  'spiegel',\n  'sr',\n  'st',\n  'su',\n  'supplies',\n  'supply',\n  'support',\n  'surf',\n  'surgery',\n  'suzuki',\n  'sv',\n  'sx',\n  'sy',\n  'sydney',\n  'systems',\n  'sz',\n  'taipei',\n  'tatar',\n  'tattoo',\n  'tax',\n  'tc',\n  'td',\n  'technology',\n  'tel',\n  'temasek',\n  'tf',\n  'tg',\n  'th',\n  'tienda',\n  'tips',\n  'tires',\n  'tirol',\n  'tj',\n  'tk',\n  'tl',\n  'tm',\n  'tn',\n  'to',\n  'today',\n  'tokyo',\n  'tools',\n  'top',\n  'town',\n  'toys',\n  'tp',\n  'tr',\n  'trade',\n  'training',\n  'travel',\n  'trust',\n  'tt',\n  'tui',\n  'tv',\n  'tw',\n  'tz',\n  'ua',\n  'ug',\n  'uk',\n  'university',\n  'uno',\n  'uol',\n  'us',\n  'uy',\n  'uz',\n  'va',\n  'vacations',\n  'vc',\n  've',\n  'vegas',\n  'ventures',\n  'versicherung',\n  'vet',\n  'vg',\n  'vi',\n  'viajes',\n  'video',\n  'villas',\n  'vision',\n  'vlaanderen',\n  'vn',\n  'vodka',\n  'vote',\n  'voting',\n  'voto',\n  'voyage',\n  'vu',\n  'wales',\n  'wang',\n  'watch',\n  'webcam',\n  'website',\n  'wed',\n  'wedding',\n  'wf',\n  'whoswho',\n  'wien',\n  'wiki',\n  'williamhill',\n  'wme',\n  'work',\n  'works',\n  'world',\n  'ws',\n  'wtc',\n  'wtf',\n  'xn--1qqw23a',\n  'xn--3bst00m',\n  'xn--3ds443g',\n  'xn--3e0b707e',\n  'xn--45brj9c',\n  'xn--45q11c',\n  'xn--4gbrim',\n  'xn--55qw42g',\n  'xn--55qx5d',\n  'xn--6frz82g',\n  'xn--6qq986b3xl',\n  'xn--80adxhks',\n  'xn--80ao21a',\n  'xn--80asehdb',\n  'xn--80aswg',\n  'xn--90a3ac',\n  'xn--b4w605ferd',\n  'xn--c1avg',\n  'xn--cg4bki',\n  'xn--clchc0ea0b2g2a9gcd',\n  'xn--czr694b',\n  'xn--czrs0t',\n  'xn--czru2d',\n  'xn--d1acj3b',\n  'xn--d1alf',\n  'xn--fiq228c5hs',\n  'xn--fiq64b',\n  'xn--fiqs8s',\n  'xn--fiqz9s',\n  'xn--flw351e',\n  'xn--fpcrj9c3d',\n  'xn--fzc2c9e2c',\n  'xn--gecrj9c',\n  'xn--h2brj9c',\n  'xn--hxt814e',\n  'xn--i1b6b1a6a2e',\n  'xn--io0a7i',\n  'xn--j1amh',\n  'xn--j6w193g',\n  'xn--kprw13d',\n  'xn--kpry57d',\n  'xn--kput3i',\n  'xn--l1acc',\n  'xn--lgbbat1ad8j',\n  'xn--mgb9awbf',\n  'xn--mgba3a4f16a',\n  'xn--mgbaam7a8h',\n  'xn--mgbab2bd',\n  'xn--mgbayh7gpa',\n  'xn--mgbbh1a71e',\n  'xn--mgbc0a9azcg',\n  'xn--mgberp4a5d4ar',\n  'xn--mgbx4cd0ab',\n  'xn--ngbc5azd',\n  'xn--node',\n  'xn--nqv7f',\n  'xn--nqv7fs00ema',\n  'xn--o3cw4h',\n  'xn--ogbpf8fl',\n  'xn--p1acf',\n  'xn--p1ai',\n  'xn--pgbs0dh',\n  'xn--q9jyb4c',\n  'xn--qcka1pmc',\n  'xn--rhqv96g',\n  'xn--s9brj9c',\n  'xn--ses554g',\n  'xn--unup4y',\n  'xn--vermgensberater-ctb',\n  'xn--vermgensberatung-pwb',\n  'xn--vhquv',\n  'xn--wgbh1c',\n  'xn--wgbl6a',\n  'xn--xhq521b',\n  'xn--xkc2al3hye2a',\n  'xn--xkc2dl3a5ee0h',\n  'xn--yfro4i67o',\n  'xn--ygbi2ammx',\n  'xn--zfr164b',\n  'xxx',\n  'xyz',\n  'yachts',\n  'yandex',\n  'ye',\n  'yoga',\n  'yokohama',\n  'youtube',\n  'yt',\n  'za',\n  'zip',\n  'zm',\n  'zone',\n  'zuerich',\n  'zw'\n]\n/** Returns whether the provided text is a known TLD (top-level domain) */\nexport function isTLD (text) {\n  return knownTLDs.indexOf(text) !== -1\n}\n\nconst knownProtocols = [\n  'http:',\n  'https:',\n  'file:',\n  'ftp:',\n  'chrome:',\n  'chrome-extension:'\n]\n/** Returns whether the provided text is a known protocol */\nexport function isProtocol (text) {\n  return knownProtocols.indexOf(text) !== -1\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/url.js","import { searchURL } from 'lib/url'\nimport { paste } from 'lib/dom'\n\nexport async function clipboardCurrentTab () {\n  await browser.tabs.update({ url: searchURL(paste()) })\n}\n\nexport async function clipboardBackgroundTab () {\n  await browser.tabs.create({ url: searchURL(paste()), active: false })\n}\n\nexport async function clipboardForegroundTab () {\n  await browser.tabs.create({ url: searchURL(paste()) })\n}\n\nexport async function clipboardNewWindow () {\n  await browser.windows.create({ url: searchURL(paste()) })\n}\n\nexport async function clipboardIncognitoWindow () {\n  await browser.windows.create({ url: searchURL(paste()), incognito: true })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modes/command/background/commands/clipboard.js","export function generateHintStrings (characters, count) {\n  const hints = ['']\n  let offset = 0\n  while (hints.length - offset < count || hints.length === 1) {\n    const hint = hints[offset++]\n    for (const c of characters) {\n      hints.push(hint + c)\n    }\n  }\n  return hints.slice(offset, offset + count)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modes/hints/background/hintStrings.js","import { Node, Transactions, DEFAULT_TIMEOUT } from './node';\nclass Connections {\n  constructor () {\n    this.connectionsByPort = new Map();\n    this.connectionsById = new Map();\n    this.nextId = 2;\n        /** Adds new connection, returning its id */\n    this.add = (port, subs, onDisconnect) => {\n            /** browser action, page actions, devtools won't have tabId or frameId */\n      const sender = port.sender;\n      let tabId;\n      if (sender.tab) { tabId = sender.tab.id; }\n      const frameId = sender.frameId;\n            /** client ids start at 2: 0 refers to self, 1 refers to core */\n      const id = this.nextId++;\n      const transactions = new Transactions();\n      const connection = { port, id, subs, onDisconnect, tabId, frameId, transactions, sender, data: {} };\n      this.connectionsByPort.set(port, connection);\n      this.connectionsById.set(id, connection);\n      return id;\n    };\n    this.remove = (port) => {\n      const connection = this.connectionsByPort.get(port);\n            // This code will clean up a connections transactions on removal, consider adding it back\n            // instead of relying on timeouts.\n            // const transactions = connection.transactions.transactions;\n            // for (const tid in transactions) {\n            //     connection.transactions.delete(tid);\n            // }\n      this.connectionsById.delete(connection.id);\n      this.connectionsByPort.delete(port);\n    };\n        /** execute callback in context of a temporary connection, used for light-client */\n    this.withTmpConnection = async (sender, callback) => {\n      let tabId;\n      if (sender.tab) { tabId = sender.tab.id; }\n      const frameId = sender.frameId;\n      const id = this.nextId++;\n      const transactions = new Transactions();\n      const connection = { id, subs: [], onDisconnect: [], tabId, frameId, transactions, sender, data: {} };\n      this.connectionsById.set(id, connection);\n      await callback(id);\n      this.connectionsById.delete(id);\n    };\n    this.getByPort = (port) => this.connectionsByPort.get(port);\n    this.getById = (id) => this.connectionsById.get(id);\n  }\n}\nclass Core extends Node {\n  constructor () {\n    super();\n    this.connections = new Connections();\n        /**\n         * The background page doubles as the Communication Administrator. It must:\n         * 1. Run its own onConnect actions on init.\n         * 2. Run every other node's onConnect actions when they connect.\n         * 3. Run every other node's onDisconnect actions when they disconnect.\n         * 4. Never execute its own onDisconnect handlers because it should never disconnect.\n         * 5. Maintain information about itself.\n         * 6. Maintain information about active connections.\n         */\n    this.init = ({ subscriptions = [], onConnect = [], onDisconnect = [], actions, log = false }) => {\n      this.initLogging(log);\n      this.subscriptions = subscriptions;\n      this.actions = actions;\n      chrome.runtime.onConnect.addListener((port) => {\n        const { subs, onConnect: onC, onDisconnect: onD } = JSON.parse(port.name);\n        const id = this.connections.add(port, subs, onD);\n        port.onDisconnect.addListener(this.disconnectListener);\n        port.onMessage.addListener(this.messageListener);\n        this.executeOnConnectionActions(id, onC);\n      });\n      this.executeOnConnectionActions(0, onConnect);\n    };\n    this.executeOnConnectionActions = (src, actionDetails) => {\n      actionDetails.forEach(({ action, arg, dst = 0 }) => {\n        this._msg(src, dst, action, arg);\n      });\n    };\n    this.getTargets = (src, dst) => {\n      let targetSelf = false;\n      let targets = [];\n      if (typeof dst === 'number') {\n        if (dst === 0 || dst === 1) {\n          targetSelf = true;\n        } else {\n          const target = this.connections.getById(dst);\n          if (!target) {\n            console.error('ERROR: attempted to message non-existent client');\n          } else if (target.closed) {\n            console.error('ERROR: attempted to message over closed connection');\n          } else {\n            targets = [target];\n          }\n        }\n      } else if (typeof dst === 'string') {\n        targetSelf = this.subscriptions.includes(dst);\n        targets = this.getStringTargets(src, dst);\n      } else {\n        console.error('ERROR: dst type is invalid');\n      }\n      return [targetSelf, targets];\n    };\n        /**\n         * If the destination includes the current node, execute the action locally.\n         * Also send an action message to every other destination node.\n         * TODO: CLEAN THIS UP\n         */\n    this._msg = (src, dst, action, arg) => {\n      const [targetSelf, targets] = this.getTargets(src, dst);\n      if (targetSelf) { this.actionHandler(action, arg, src); }\n      targets.forEach(({ port }) => {\n        if (port) {\n          this.log('Tx', 'msg', src, dst, action, arg);\n          port.postMessage({ t: 'msg', src, dst, action, arg });\n        } else {\n          throw Error('No messaging light-clients');\n        }\n      });\n    };\n    this.msg = this._msg.bind(undefined, 1);\n        /**\n         * A destination is composed of multiple subdestinations separated by semicolons.\n         * A connection receives a message if it is part of any subdestination.\n         * A subdestination is composed of multiple conditions separated by periods.\n         * A connection is part of a subdestination if it satisfies all its conditions.\n         * This is conceptually akin to a conjunctive normal form (OR of AND) boolean formula.\n         * getStringTargets should not include the local node as that is handled by a separate\n         * local action handler.\n         */\n    this.getStringTargets = (src, dst) => {\n            /** Returns true if the given connection is part of the destination, else false */\n      const predicate = (connection) => {\n        if (connection.closed) { return false; }\n        for (const subDst of dst.split('|')) {\n          const allConditionsMet = subDst.split('&').map((condition) => {\n            if (connection.subs.includes(condition)) {\n              return true;\n            }\n            if (condition === 'topFrame') {\n              return connection.frameId === 0;\n            }\n            if (condition === 'childFrames') {\n              return connection.frameId !== 0;\n            }\n            if (condition === 'otherFrames') {\n              return connection.frameId !== this.connections.getById(src).frameId;\n            }\n            if (condition === 'thisTab') {\n              return connection.tabId === this.connections.getById(src).tabId;\n            }\n            if (condition === 'other') {\n              return connection.id !== this.connections.getById(src).id;\n            }\n            const tabCondition = condition.match(/tab\\[(\\d+)\\]/);\n            if (tabCondition) {\n              return connection.tabId === parseInt(tabCondition[1], 10);\n            }\n            const frameCondition = condition.match(/frame\\[(\\d+)\\]/);\n            if (frameCondition) {\n              return connection.frameId === parseInt(frameCondition[1], 10);\n            }\n            const idCondition = condition.match(/id\\[(\\d+)\\]/);\n            if (idCondition) {\n              return connection.id === parseInt(idCondition[1], 10);\n            }\n            return false;\n          }).every((conditionMet) => conditionMet);\n          if (allConditionsMet) { return true; }\n        }\n        return false;\n      };\n            // TODO: review perfomance cost of array conversion, perhaps rewrite to avoid conversion\n      return [...this.connections.connectionsById.values()].filter(predicate);\n    };\n    this._getLocal = async (src, action, arg) => {\n      try {\n        return { id: 1, v: await this.actionHandler(action, arg, src) };\n      } catch (error) {\n        return { id: 1, e: error };\n      }\n    };\n    this._getRemote = (connection, src, action, arg, timeout) => {\n      return new Promise((resolve, reject) => {\n        const tid = connection.transactions.new(resolve, reject, timeout);\n        if (connection.port) {\n          this.log('Tx', 'get', src, connection.id, action, arg, tid);\n          connection.port.postMessage({ t: 'get', src, dst: connection.id, action, arg, tid });\n        } else {\n          throw Error('No messaging light-clients');\n        }\n      });\n    };\n    this._get = (src, dst, action, arg, timeout = DEFAULT_TIMEOUT) => {\n      const [targetSelf, targets] = this.getTargets(src, dst);\n      const localResult = (targetSelf)\n                ? [this._getLocal(src, action, arg)]\n                : [];\n      const remoteResults = targets.map((target) => {\n        return this._getRemote(target, src, action, arg, timeout);\n      });\n            // TODO: Proper Promise handling (don't fail if any fails)\n      try {\n        return Promise.all([...localResult, ...remoteResults]);\n      } catch (e) {\n        console.error(e, 'connections: ', this.connections);\n        return Promise.resolve([]);\n      }\n    };\n    this.get = this._get.bind(undefined, 1);\n        /**\n         * Executes onDisconnt actions and deletes data associated with connection.\n         * Connection is marked as closed so that no messages are sent to it when executing\n         * onDisconnect actions.\n         */\n    this.disconnectListener = (port) => {\n      const connection = this.connections.getByPort(port);\n      connection.closed = true;\n      this.executeOnConnectionActions(connection.id, connection.onDisconnect);\n      this.connections.remove(port);\n    };\n        /**\n         * Handles messages on receipt by calling the appropriate internal function\n         */\n    this.messageListener = ({ src, dst, t, action, arg, tid, res, timeout }, port) => {\n      if (src === undefined) { src = this.connections.getByPort(port).id; }\n      switch (t) {\n        case 'msg':\n          this.log('Rx', 'msg', src, dst, action, arg);\n          this._msg(src, dst, action, arg);\n          break;\n        case 'get':\n          this.log('Rx', 'get', src, dst, action, arg, tid);\n          this._get(src, dst, action, arg, timeout).then((result) => {\n            this.log('Tx', 'rsp', src, dst, action, result, tid);\n            port.postMessage({ t: 'rsp', src: dst, dst: src, action, res: result, tid });\n          }).catch((e) => {\n            this.log('Tx', 'rsp', src, dst, action, { e }, tid);\n            port.postMessage({ t: 'rsp', src: dst, dst: src, action, res: { e }, tid });\n          });\n          break;\n        case 'rsp':\n          this.log('Rx', 'rsp', src, dst, action, res, tid);\n          const connection = this.connections.getByPort(port);\n          if (connection) {\n            connection.transactions.complete(tid, res);\n          }\n                    // the code may get here if a transaction is received over a connection\n                    // that subsequently closed. Do nothing, a timeout will trigger the\n                    // reject handler automatically.\n          break;\n        default:\n          throw Error(`Invalid message class: ${t}`);\n      }\n    };\n    this.meta = (connectionId) => {\n      const connection = this.connections.getById(connectionId);\n      if (connection) {\n        return {\n          frameId: connection.frameId,\n          tabId: connection.tabId,\n          sender: connection.sender,\n          subs: connection.subs,\n          data: connection.data\n        };\n      }\n      return undefined;\n    };\n        /** adds a listener for light-client messages */\n    chrome.runtime.onMessage.addListener(({ mosi_lw_msg, dst, action, arg }, sender) => {\n      if (mosi_lw_msg) {\n        this.log('Rx', 'msg', 'lw_client', dst, action, arg);\n        this.connections.withTmpConnection(sender, async (connectionId) => {\n          await this._msg(connectionId, dst, action, arg);\n        });\n      }\n    });\n  }\n}\nconst node = new Core();\nconst init = node.init;\nconst msg = node.msg;\nconst get = node.get;\nconst meta = node.meta;\nexport { init, msg, meta, get };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/mosi/core.js\n// module id = null\n// module chunks = ","import * as tabCommands from './commands/tab'\nimport * as clipboardCommands from './commands/clipboard'\n\nexport default {\n  messages: {\n    ...tabCommands,\n    ...clipboardCommands\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modes/command/background/index.js","import { msg, get, meta } from 'mosi/core'\nimport { generateHintStrings } from './hintStrings'\n\nlet hintChars = 'adsfghjkl;'\nlet autoActivateHint = false\n\nexport default {\n  onOptionsChange: options => {\n    hintChars = options.hintChars.length >= 2 ? options.hintChars : 'bad'\n    autoActivateHint = options.autoActivateHint\n  },\n  messages: {\n    findHints: async (config, src) => {\n      // Gather the number of hintable elements in each frame\n      const currentTabTarget = `tab[${meta(src).tabId}]|id[${src}]`\n      const hintsPerFrame = await get(currentTabTarget, 'findHints', config)\n      const totalHints = hintsPerFrame.reduce((total, { v }) => total + v, 0)\n      // If no hints, immediately exit Hints mode\n      if (totalHints === 0) {\n        msg(currentTabTarget, 'exitHintsMode')\n        // If exactly one hint, immediately activate it (if autoactivation enabled by user)\n      } else if (totalHints === 1 && autoActivateHint) {\n        const { id } = hintsPerFrame.find(({ v, id }) => v === 1)\n        const [{ v: nextMode }] = await get(id, 'activateFirstHint')\n        msg(currentTabTarget, 'exitHintsMode', nextMode)\n        // If multiple hints, trigger hint rendering\n      } else {\n        const hintStrings = generateHintStrings(hintChars, totalHints)\n        let offset = 0\n        hintsPerFrame.forEach(({ id, v }) => {\n          const nextOffset = offset + v\n          msg(id, 'renderHints', hintStrings.slice(offset, nextOffset))\n          offset = nextOffset\n        })\n      }\n    },\n    processKey: async (event, src) => {\n      const currentTabTarget = `tab[${meta(src).tabId}]|id[${src}]`\n      try {\n        const results = await get(currentTabTarget, 'advanceHints', event)\n        if (results.every(({ v }) => v === 'Filtered')) {\n          msg(currentTabTarget, 'exitHintsMode')\n          return\n        }\n        const nextMode = results.find(\n          ({ v }) => v !== 'Same' && v !== 'Filtered' && v !== undefined\n        )\n        if (nextMode) {\n          msg(currentTabTarget, 'exitHintsMode', nextMode.v)\n        }\n      } catch (e) {}\n    },\n    openLinkInIncognitoWindow: url => {\n      // TODO: consider more robust URL verification like Vimium's\n      browser.windows.create({ url, incognito: true })\n    },\n    // Needed to activate links on firefox because it ignores keyboard modifiers\n    // or doesn't execute default behaviors on click events\n    ...(SAKA_PLATFORM === 'chrome'\n      ? {}\n      : {\n        openLinkInBackgroundTab: url => {\n          browser.tabs.create({ url, active: false })\n        },\n        openLinkInForegroundTab: url => {\n          browser.tabs.create({ url, active: true })\n        },\n        openLinkInNewWindow: url => {\n          browser.windows.create({ url })\n        }\n      })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modes/hints/background/index.js","import 'lib/browser_polyfill'\nimport { init } from 'mosi/core'\nimport {\n  loadClient,\n  initModes,\n  setup,\n  clientOptions\n} from 'background_page/modes'\nimport Command from 'modes/command/background'\nimport Hints from 'modes/hints/background'\n\nif (SAKA_DEBUG) {\n  console.log('background page initialize begin')\n}\n\n// messaging endpoints, see Mosi (https://github.com/eejdoowad/mosi)\nconst actions = {\n  loadClient,\n  clientOptions\n}\n\n// initialize messaging system\ninit({\n  log: SAKA_DEBUG,\n  actions\n})\n\ninitModes(\n  {\n    Command,\n    Hints\n  },\n  actions\n)\n\nsetup()\n\nif (SAKA_DEBUG) {\n  console.log(`background page initialized for version ${SAKA_VERSION}`)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/background_page/index.js"],"sourceRoot":""}